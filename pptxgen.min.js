// pptx-generator.js

document.getElementById('generatePptx').addEventListener('click', async () => {
    const pptx = new PptxGenJS();
    
    // Define a subtle background color to match the web design's off-white
    pptx.defineSlideMaster({
        title: 'MASTER_STYLE',
        background: { fill: 'F7F5F0' } // Using the CSS variable --bg-color
    });

    const slide = pptx.addSlide({ masterName: 'MASTER_STYLE' });

    // --- 1. STATUS Title and Description ---
    
    // Add the "STATUS" Title
    slide.addText(
        'STATUS', 
        { 
            x: 0.5, y: 1.0, 
            w: 3.0, h: 0.5, 
            fontFace: 'Times New Roman', 
            fontSize: 48, 
            color: '333333',
        }
    );

    // Add the Description (simplified for PPTX)
    const descriptionText = "Lorem ipsum dolor sit amet, animal graecis pro no, dice adhuc persequeris et qui. Mea eu integre proprias.";
    slide.addText(
        descriptionText,
        {
            x: 0.5, y: 1.8,
            w: 3.5, h: 0.7,
            fontSize: 10,
            color: '888888',
        }
    );

    // --- 2. Data Cards (Text Only - Images are complex in PPTX) ---
    const cardData = [
        { number: '29,050', label: 'Lorem ipsum dolor' },
        { number: '37,800', label: 'Lorem ipsum dolor' },
        { number: '52,300', label: 'Lorem ipsum dolor' },
    ];
    
    // Starting X position for the first card
    let startX = 5.0; 
    const spacing = 2.5; 

    cardData.forEach((data, index) => {
        const currentX = startX + (index * spacing);
        
        // Add the Number
        slide.addText(
            data.number,
            {
                x: currentX, y: 4.8, 
                w: spacing - 0.5, h: 0.3,
                fontSize: 20, 
                bold: true,
                align: 'center', 
                color: '333333'
            }
        );

        // Add the Label
        slide.addText(
            data.label,
            {
                x: currentX, y: 5.2, 
                w: spacing - 0.5, h: 0.2,
                fontSize: 12, 
                align: 'center', 
                color: '888888'
            }
        );
        
        // Note: To add the images in PPTX, you'd use slide.addImage()
        // and specify the local path/URL to the image files.
        /*
        slide.addImage({
            path: 'path/to/image.jpg', 
            x: currentX, y: 1.0, 
            w: 2.0, h: 3.5,
            sizing: { type: 'cover', w: 2.0, h: 3.5 }, // Helps with aspect ratio
            // Oval clipping isn't a direct feature in PPTX slides, but images can be added.
        });
        */
    });

    // --- 3. Save Presentation ---
    pptx.writeFile({ fileName: 'Status_Report_Design.pptx' });
});